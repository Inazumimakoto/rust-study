# ç¬¬10ç« : ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ãƒ»ãƒˆãƒ¬ã‚¤ãƒˆãƒ»ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ 

## ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ï¼ˆGenericsï¼‰

**å‹ã®é‡è¤‡ã‚’æ’é™¤ï¼C++ ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨åŒã˜ï¼**

### é–¢æ•°

```rust
fn largest<T>(list: &[T]) -> T { ... }
//        â†‘ å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
```

### æ§‹é€ ä½“

```rust
struct Point<T> {
    x: T,
    y: T,
}
```

### C++ ã¨ã®æ¯”è¼ƒ

| | C++ | Rust |
|---|-----|------|
| æ§‹æ–‡ | `template<typename T>` | `<T>` |
| ä¾‹ | `vector<int>` | `Vec<i32>` |

```cpp
// C++
template<typename T>
T largest(std::vector<T> list) { ... }
```

```rust
// Rust
fn largest<T>(list: &[T]) -> T { ... }
```

### ãªãœ `impl<T>`ï¼Ÿ

```rust
struct Point<T> { x: T, y: T }

impl<T> Point<T> {
//   â†‘ ã€ŒT ã¯ã‚¸ã‚§ãƒãƒªãƒƒã‚¯å‹ã€ã¨å®£è¨€
    fn x(&self) -> &T { &self.x }
}
```

**ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã€ŒT ã¯å…·ä½“çš„ãªå‹åã˜ã‚ƒãªãã¦ã‚¸ã‚§ãƒãƒªãƒƒã‚¯ã€ã¨æ•™ãˆã‚‹ï¼**

---

## ãƒˆãƒ¬ã‚¤ãƒˆï¼ˆTraitsï¼‰

**ã€Œã“ã®æ©Ÿèƒ½ã‚’æŒã£ã¦ã¾ã™ã€ã¨ã„ã†ç´„æŸï¼**

### å®šç¾©

```rust
trait Animal {
    fn eat(&self);
    fn display(&self);
}
```

### å®Ÿè£…

```rust
impl Animal for Dog {
    fn eat(&self) { println!("çŠ¬ãŒé£Ÿã¹ã‚‹"); }
    fn display(&self) { println!("çŠ¬ã ã‚ˆ"); }
}
```

### ãªãœãƒˆãƒ¬ã‚¤ãƒˆï¼Ÿ

**é•ã†å‹ã‚’åŒã˜ã‚ˆã†ã«æ‰±ãˆã‚‹ï¼**

```rust
fn feed_all(animals: Vec<&dyn Animal>) {
    for a in animals {
        a.eat();  // Dog ã§ã‚‚ Cat ã§ã‚‚ OKï¼
    }
}
```

---

## å„è¨€èªã¨ã®æ¯”è¼ƒ

### Java

```java
// ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
interface Animal {
    void eat();
}

// å®Ÿè£…
class Dog implements Animal {
    public void eat() { ... }
}

// ä½¿ã†
void feedAll(List<Animal> animals) { ... }
```

### Rust

```rust
// ãƒˆãƒ¬ã‚¤ãƒˆ
trait Animal {
    fn eat(&self);
}

// å®Ÿè£…
impl Animal for Dog {
    fn eat(&self) { ... }
}

// ä½¿ã†
fn feed_all(animals: Vec<&dyn Animal>) { ... }
```

### C++

```cpp
// æŠ½è±¡ã‚¯ãƒ©ã‚¹
class Animal {
public:
    virtual void eat() = 0;  // ç´”ç²‹ä»®æƒ³é–¢æ•°
};

// å®Ÿè£…
class Dog : public Animal {
    void eat() override { ... }
};
```

---

## Rust ã¨ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘

| OOPã®ç‰¹å¾´ | Java | C++ | Rust |
|-----------|------|-----|------|
| ã‚«ãƒ—ã‚»ãƒ«åŒ– | âœ… | âœ… | âœ… |
| å¤šæ…‹æ€§ | âœ… | âœ… | âœ…ï¼ˆãƒˆãƒ¬ã‚¤ãƒˆï¼‰|
| ç¶™æ‰¿ | âœ… | âœ… | **âŒ ãªã—ï¼** |

**Rust ã¯ã€Œç¶™æ‰¿ã®ãªã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã€ï¼**

### ãªãœç¶™æ‰¿ãŒãªã„ï¼Ÿ

**1. ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰å•é¡Œ**

```
       Animal
       /    \
     Dog    Cat
       \    /
       DogCat  â† ğŸ’€ Animal ãŒ2ã¤ã‚ã‚‹ï¼
```

**2. ç¶™æ‰¿ã¯å¯†çµåˆ**

è¦ªã‚’å¤‰ãˆã‚‹ã¨å­ãŒå…¨éƒ¨å£Šã‚Œã‚‹ğŸ˜­

**3. ç¶™æ‰¿ã‚ˆã‚Šåˆæˆï¼ˆComposition over Inheritanceï¼‰**

```rust
// ç¶™æ‰¿ã˜ã‚ƒãªãã¦ã€ŒæŒã¤ã€
struct Dog {
    animal_data: AnimalData,
}
```

**4. ãƒˆãƒ¬ã‚¤ãƒˆã§è§£æ±º**

```rust
trait Walkable { fn walk(&self); }
trait Swimmable { fn swim(&self); }

// è¤‡æ•°ãƒˆãƒ¬ã‚¤ãƒˆã‚’å®Ÿè£…ã§ãã‚‹ï¼ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰å•é¡Œãªã—ï¼
impl Walkable for Duck { ... }
impl Swimmable for Duck { ... }
```

| å•é¡Œ | ç¶™æ‰¿ | ãƒˆãƒ¬ã‚¤ãƒˆ |
|------|------|---------|
| ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰å•é¡Œ | ğŸ’€ | âœ… ãªã— |
| å¯†çµåˆ | ğŸ˜­ | âœ… ç–çµåˆ |
| æŸ”è»Ÿæ€§ | ä½ã„ | é«˜ã„ |

**ç¶™æ‰¿ã¯ä¾¿åˆ©ã«è¦‹ãˆã¦ç½ ãŒå¤šã„ï¼ãƒˆãƒ¬ã‚¤ãƒˆã®æ–¹ãŒå®‰å…¨ï¼**

---

## ãƒˆãƒ¬ã‚¤ãƒˆå¢ƒç•Œ

**ã€Œã“ã®å‹ã¯ã“ã®ãƒˆãƒ¬ã‚¤ãƒˆã‚’å®Ÿè£…ã—ã¦ã‚‹ã€ã¨ã„ã†åˆ¶ç´„**

```rust
fn largest<T: PartialOrd>(list: &[T]) -> T {
//           â†‘ ã€Œæ¯”è¼ƒã§ãã‚‹å‹ã ã‘OKã€
    ...
}
```

### è¤‡æ•°ã®ãƒˆãƒ¬ã‚¤ãƒˆå¢ƒç•Œ

```rust
fn some_function<T: Display + Clone>(t: T) { ... }
```

### where æ§‹æ–‡

```rust
fn some_function<T, U>(t: T, u: U)
where
    T: Display + Clone,
    U: Clone,
{ ... }
```

---

## ğŸ’¡ å­¦ã‚“ã ã“ã¨

- **ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹** = å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§é‡è¤‡æ’é™¤
- **ãƒˆãƒ¬ã‚¤ãƒˆ** = ã€Œæ©Ÿèƒ½ã®ç´„æŸã€ï¼ˆJava ã® interface ç›¸å½“ï¼‰
- **Rust ã«ç¶™æ‰¿ã¯ãªã„ï¼** ãƒˆãƒ¬ã‚¤ãƒˆã§æ©Ÿèƒ½ã‚’çµ„ã¿åˆã‚ã›ã‚‹
- **ãƒˆãƒ¬ã‚¤ãƒˆå¢ƒç•Œ** = ã€Œã“ã®æ©Ÿèƒ½ã‚’æŒã¤å‹ã ã‘ã€ã¨ã„ã†åˆ¶ç´„
- `impl<T>` = ã€ŒT ã¯ã‚¸ã‚§ãƒãƒªãƒƒã‚¯å‹ã§ã™ã€å®£è¨€

---

## ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ï¼ˆLifetimesï¼‰

**å‚ç…§ãŒã€Œã„ã¤ã¾ã§æœ‰åŠ¹ã‹ã€ã®ãƒ«ãƒ¼ãƒ«ï¼**

### ãªãœå¿…è¦ï¼Ÿ

```rust
fn longest(x: &str, y: &str) -> &str {
    if x.len() > y.len() { x } else { y }
}
// âŒ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ï¼
```

**ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã€Œè¿”ã‚Šå€¤ã¯ x ã®å¯¿å‘½ï¼Ÿy ã®å¯¿å‘½ï¼Ÿã‚ã‹ã‚‰ã‚“ï¼ã€**

### ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ æ³¨é‡ˆ

```rust
fn longest<'a>(x: &'a str, y: &'a str) -> &'a str {
//         â†‘      â†‘           â†‘           â†‘
//         |      +-- x ã‚‚ y ã‚‚è¿”ã‚Šå€¤ã‚‚åŒã˜å¯¿å‘½ 'a
//         +-- ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å®£è¨€
    if x.len() > y.len() { x } else { y }
}
```

### ä½•ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ï¼Ÿ

```rust
let s1 = String::from("hello");
let result;
{
    let s2 = String::from("world");
    result = longest(&s1, &s2);  // 'a = s2 ã®å¯¿å‘½ï¼ˆçŸ­ã„æ–¹ï¼‰
}  // s2 æ­»äº¡
println!("{}", result);  // âŒ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ï¼
```

**ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã€Œs2 ãŒæ­»ã‚“ã å¾Œã¯ result ä½¿ãˆãªã„ã‚ˆï¼ã€**

### æ­£ã—ã„ä½¿ã„æ–¹

```rust
let s1 = String::from("hello");
let s2 = String::from("world");
let result = longest(&s1, &s2);  // ä¸¡æ–¹ç”Ÿãã¦ã‚‹
println!("{}", result);  // âœ… OK
```

---

## C++ ã§å®Ÿé¨“

```cpp
// C++ ã§ã¯ä½•ã‚‚è­¦å‘Šã—ãªã„ï¼
string& longest(string& x, string& y) {
    return x.length() > y.length() ? x : y;
}

int main() {
    string s1 = "hello";
    string* result;
    {
        string s2 = "world!!!";
        result = &longest(s1, s2);
    }  // s2 ãŒæ­»ã¬
    
    cout << *result << endl;  // ğŸ’€ ãƒ€ãƒ³ã‚°ãƒªãƒ³ã‚°å‚ç…§ï¼
}
```

**C++ ã¯ã€Œå‹•ãã‘ã©å±é™ºã€ï¼Rust ã¯ã€Œã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§æ­¢ã‚ã‚‹ã€ï¼**

---

## ğŸ’¡ å­¦ã‚“ã ã“ã¨ï¼ˆè¿½åŠ ï¼‰

- **ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ** = å‚ç…§ãŒæœ‰åŠ¹ãªæœŸé–“
- **`'a`** = ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆã‚¸ã‚§ãƒãƒªãƒƒã‚¯ã¿ãŸã„ãªã‚‚ã®ï¼‰
- é–¢æ•°ãŒå‚ç…§ã‚’è¿”ã™ã¨ãã€ã€Œå¼•æ•°ã¨ã©ã†é–¢ä¿‚ã™ã‚‹ã‹ã€ã‚’æ›¸ã
- **æ³¨é‡ˆ = é–¢æ•°ã®ä½¿ã„æ–¹ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©**
- C++ ã¯ãƒ€ãƒ³ã‚°ãƒªãƒ³ã‚°å‚ç…§ãŒå®Ÿè¡Œæ™‚ã«ğŸ’€ã€Rust ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«ã‚¨ãƒ©ãƒ¼ï¼

