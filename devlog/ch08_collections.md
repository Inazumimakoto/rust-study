# ç¬¬8ç« : ä¸€èˆ¬çš„ãªã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³

## ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯

**æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¾¿åˆ©ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ï¼**

| Rust | C++ | ç”¨é€” |
|------|-----|------|
| `Vec<T>` | `std::vector<T>` | å¯å¤‰é•·é…åˆ— |
| `String` | `std::string` | æ–‡å­—åˆ— |
| `HashMap<K, V>` | `std::unordered_map<K, V>` | ã‚­ãƒ¼ã¨å€¤ |

---

## Vecï¼ˆãƒ™ã‚¯ã‚¿ï¼‰

### ä½œæˆ

```rust
// ç©ºã®ãƒ™ã‚¯ã‚¿ï¼ˆå‹ã‚’æ˜è¨˜ï¼ï¼‰
let v: Vec<i32> = Vec::new();

// vec! ãƒã‚¯ãƒ­ï¼ˆå‹ã¯æ¨è«–ã•ã‚Œã‚‹ï¼‰
let v = vec![1, 2, 3];
```

### è¦ç´ ã®è¿½åŠ 

```rust
let mut v = Vec::new();
v.push(1);
v.push(2);
```

### è¦ç´ ã®å–å¾—

```rust
let v = vec![1, 2, 3, 4, 5];

// æ·»å­—ï¼ˆç¯„å›²å¤–ã§ãƒ‘ãƒ‹ãƒƒã‚¯ï¼‰
let third = &v[2];

// getï¼ˆOption ã‚’è¿”ã™ã€å®‰å…¨ï¼‰
match v.get(2) {
    Some(x) => println!("{}", x),
    None => println!("ãªã„"),
}
```

---

## å€Ÿç”¨è¦å‰‡ã¨ Vec

### âŒ ãƒ€ãƒ¡ãªä¾‹

```rust
let mut v = vec![1, 2, 3];
let first = &v[0];  // ä¸å¤‰å€Ÿç”¨
v.push(6);          // âŒ å¯å¤‰å€Ÿç”¨ã§ããªã„ï¼
println!("{}", first);
```

**ãªãœï¼Ÿpush ã§å†å‰²ã‚Šå½“ã¦ãŒèµ·ããŸã‚‰ first ãŒç„¡åŠ¹ã«ãªã‚‹ã‹ã‚‚ï¼**

### âœ… è§£æ±ºç­–

```rust
let mut v = vec![1, 2, 3];
let first = &v[0];
println!("{}", first);  // ä½¿ã„çµ‚ã‚ã‚‹
v.push(6);  // âœ… ã‚‚ã† first ã¯ä½¿ã£ã¦ãªã„
```

---

## NLLï¼ˆNon-Lexical Lifetimesï¼‰

**å€Ÿç”¨ã¯ã€Œæœ€å¾Œã«ä½¿ã£ãŸå ´æ‰€ã€ã§çµ‚ã‚ã‚‹ï¼**

```rust
let first = &v[0];  // å€Ÿç”¨é–‹å§‹
println!("{}", first);  // â† æœ€å¾Œã«ä½¿ã† = å€Ÿç”¨çµ‚äº†
v.push(6);  // âœ… å€Ÿç”¨ã¯çµ‚ã‚ã£ã¦ã‚‹
```

**ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯ã€Œã“ã®å¾Œä½¿ã†ï¼Ÿã€ã‚’è¦‹ã¦ã‚‹ï¼**

---

## for ãƒ«ãƒ¼ãƒ—

### ä¸å¤‰å‚ç…§

```rust
let v = vec![1, 2, 3];
for i in &v {
    println!("{}", i);
}
```

### å¯å¤‰å‚ç…§

```rust
let mut v = vec![100, 32, 57];
for i in &mut v {
    *i += 50;  // * ã§ãƒ‡ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹
}
// v = [150, 82, 107]
```

**`*i` = å‚ç…§å…ˆã®å€¤ã«ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆC++ ã¨åŒã˜ï¼‰**

### ãªãœ `println!` ã¯ * ä¸è¦ï¼Ÿ

```rust
for i in &v {
    println!("{}", i);  // âœ… * ãªã—ã§OK
}

for i in &mut v {
    *i += 50;  // âŒ * å¿…è¦ï¼
}
```

| æ“ä½œ | è‡ªå‹•ãƒ‡ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ |
|------|------------------|
| `println!` | âœ… ã™ã‚‹ |
| `+=` `-=` ãªã© | âŒ ã—ãªã„ï¼ˆæ˜ç¤ºçš„ã« `*`ï¼‰|

**Rust ã¯ã€Œèª­ã¿å–ã‚Šã€ã¯è‡ªå‹•ã€ã€Œå¤‰æ›´ã€ã¯æ˜ç¤ºçš„ï¼ï¼ˆã‚ã‚“ã©ãã›ï¼ï¼‰**

---

## Enum ã§è¤‡æ•°å‹ã‚’å…¥ã‚Œã‚‹

```rust
enum Cell {
    Int(i32),
    Float(f64),
    Text(String),
}

let row = vec![
    Cell::Int(3),
    Cell::Text(String::from("blue")),
    Cell::Float(10.12),
];
```

**Vec ã¯1å‹ã ã‘ã©ã€Enum ãªã‚‰è¤‡æ•°ç¨®é¡OKï¼**

---

## ğŸ’¡ å­¦ã‚“ã ã“ã¨ï¼ˆVecï¼‰

- `Vec::new()` ã¯å‹ã‚’æ˜è¨˜ã€`vec![]` ã¯æ¨è«–
- `push()` ã§è¿½åŠ ã€`get()` ã¯å®‰å…¨ï¼ˆOptionï¼‰
- å€Ÿç”¨ä¸­ã¯ push ã§ããªã„ï¼ˆå†å‰²ã‚Šå½“ã¦ã®å±é™ºï¼‰
- NLL: ã€Œæœ€å¾Œã«ä½¿ã£ãŸå ´æ‰€ã€ã§å€Ÿç”¨çµ‚äº†
- `*i` ã§ãƒ‡ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹
- Enum ã§è¤‡æ•°å‹ã‚’å…¥ã‚Œã‚‰ã‚Œã‚‹

---

## Stringï¼ˆæ–‡å­—åˆ—ï¼‰

### å‘½åè¦å‰‡

| ç¨®é¡ | å‘½å | ä¾‹ |
|------|------|-----|
| å‹/æ§‹é€ ä½“/Enum | PascalCase | `String`, `OsString` |
| é–¢æ•°/å¤‰æ•° | snake_case | `to_string()`, `push_str()` |

### String vs &str

```rust
let s1: &str = "hello";                  // æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ï¼ˆå‚ç…§ï¼‰
let s2: String = String::from("hello");  // Stringï¼ˆãƒ’ãƒ¼ãƒ—ï¼‰
let s3: String = "hello".to_string();    // ã“ã‚Œã‚‚åŒã˜
```

| | `&str` | `String` |
|---|--------|----------|
| å ´æ‰€ | å‚ç…§ | ãƒ’ãƒ¼ãƒ— |
| å¯å¤‰ | âŒ | âœ… |
| æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ« | âœ… | âŒ |

**ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã§æ›¸ã„ãŸæ–‡å­—åˆ— = `&str`**

### UTF-8 vs Unicode

```
Unicode = æ–‡å­—ã®ã‚«ã‚¿ãƒ­ã‚°ï¼ˆç•ªå·ï¼‰
UTF-8 = Unicode ã‚’ä¿å­˜ã™ã‚‹æ–¹æ³•ï¼ˆãƒã‚¤ãƒˆåˆ—ï¼‰

'A' â†’ UTF-8: 1ãƒã‚¤ãƒˆ
'ã‚' â†’ UTF-8: 3ãƒã‚¤ãƒˆ
'Ğ—' â†’ UTF-8: 2ãƒã‚¤ãƒˆ
```

**Rust ã® String ã¯ UTF-8 ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼**

### æ–‡å­—åˆ—æ“ä½œ

```rust
let mut s = String::from("foo");

s.push_str("bar");  // æ–‡å­—åˆ—è¿½åŠ 
s.push('!');        // 1æ–‡å­—è¿½åŠ 

// + æ¼”ç®—å­ï¼ˆs1 ã¯ move ã•ã‚Œã‚‹ï¼ï¼‰
let s1 = String::from("Hello");
let s2 = String::from("World");
let s3 = s1 + &s2;  // s1 ã¯ä½¿ãˆãªããªã‚‹

// format! ãƒã‚¯ãƒ­ï¼ˆæ‰€æœ‰æ¨©å¥ªã‚ãªã„ã€èª­ã¿ã‚„ã™ã„ï¼‰
let s = format!("{}-{}", s2, s3);
```

### å‚ç…§å¤–ã—å‹å¼·åˆ¶ï¼ˆDeref Coercionï¼‰

```rust
&String â†’ &str  // è‡ªå‹•å¤‰æ›ï¼
```

### æ·»å­—ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ï¼

```rust
let s = String::from("Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹Ñ‚Ğµ");
s[0];  // âŒ ã‚¨ãƒ©ãƒ¼ï¼
```

**UTF-8 ã¯å¯å¤‰é•·ã ã‹ã‚‰ `[0]` ãŒä½•ã‚’è¿”ã™ã¹ãã‹ã‚ã‹ã‚‰ãªã„ï¼**

```rust
// ä»£ã‚ã‚Šã®æ–¹æ³•
s.as_bytes()[0];   // ãƒã‚¤ãƒˆ
s.chars().nth(0);  // æ–‡å­—
&s[0..4];          // ã‚¹ãƒ©ã‚¤ã‚¹ï¼ˆå¢ƒç•Œæ³¨æ„ï¼ï¼‰

// æ–‡å­—ã‚’èµ°æŸ»
for c in "à¤¨à¤®à¤¸à¥à¤¤à¥‡".chars() {
    println!("{}", c);
}
```

### &str ã¨ String ã®ãƒ¡ã‚½ãƒƒãƒ‰å…±æœ‰

| ãƒ¡ã‚½ãƒƒãƒ‰ | `&str` | `String` |
|---------|--------|----------|
| `.chars()` | âœ… | âœ… |
| `.len()` | âœ… | âœ… |
| `.push()` | âŒ | âœ… |

**å¤‰æ›´ç³»ã¯ `String` ã ã‘ï¼èª­ã¿å–ã‚Šç³»ã¯ä¸¡æ–¹ï¼**

---

## ğŸ’¡ å­¦ã‚“ã ã“ã¨ï¼ˆStringï¼‰

- æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ« `"..."` ã¯ `&str`
- `to_string()` ã¨ `String::from()` ã¯åŒã˜
- UTF-8 ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆå¯å¤‰é•·ï¼‰
- æ·»å­—ã‚¢ã‚¯ã‚»ã‚¹ç¦æ­¢ï¼ˆ`.chars()` ã‚’ä½¿ã†ï¼‰
- `+` ã¯å·¦å´ã®æ‰€æœ‰æ¨©ã‚’å¥ªã†ã€`format!` ã¯å¥ªã‚ãªã„
- `&String` â†’ `&str` è‡ªå‹•å¤‰æ›ï¼ˆå‚ç…§å¤–ã—å‹å¼·åˆ¶ï¼‰

---

## HashMapï¼ˆãƒãƒƒã‚·ãƒ¥ãƒãƒƒãƒ—ï¼‰

C++ ã® `std::unordered_map` ã¨åŒã˜ï¼

### ä½œæˆ

```rust
use std::collections::HashMap;

let mut scores = HashMap::new();
scores.insert(String::from("Blue"), 10);
scores.insert(String::from("Yellow"), 50);
```

### å–å¾—

```rust
let team_name = String::from("Blue");
let score = scores.get(&team_name);  // Some(&10) or None
```

### èµ°æŸ»

```rust
for (key, value) in &scores {
    println!("{}: {}", key, value);
}
```

### æ‰€æœ‰æ¨©ã«æ³¨æ„ï¼

```rust
let key = String::from("Blue");
let value = String::from("10");
map.insert(key, value);  // key, value ã¯ move ã•ã‚Œã‚‹ï¼
// println!("{}", key);  // âŒ ä½¿ãˆãªã„ï¼
```

### ä¸Šæ›¸ã

```rust
scores.insert(String::from("Blue"), 10);
scores.insert(String::from("Blue"), 25);  // 25 ã«ä¸Šæ›¸ã
```

### ã‚­ãƒ¼ãŒãªã„æ™‚ã ã‘æŒ¿å…¥

```rust
scores.entry(String::from("Yellow")).or_insert(50);
scores.entry(String::from("Blue")).or_insert(50);  // Blue ã¯ã‚ã‚‹ã‹ã‚‰ä½•ã‚‚ã—ãªã„
```

### å˜èªã‚«ã‚¦ãƒ³ãƒˆã®ä¾‹

```rust
let text = "hello world wonderful world";
let mut map = HashMap::new();

for word in text.split_whitespace() {
    let count = map.entry(word).or_insert(0);
    //          â†‘ ãªã‹ã£ãŸã‚‰ 0 ã‚’å…¥ã‚Œã¦ &mut ã‚’è¿”ã™
    //            ã‚ã£ãŸã‚‰æ—¢å­˜ã® &mut ã‚’è¿”ã™
    *count += 1;
}
// {"hello": 1, "world": 2, "wonderful": 1}
```

**`or_insert(0)` = ã€Œãªã‹ã£ãŸã‚‰ 0 ã‹ã‚‰å§‹ã‚ã‚‹ã€ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼**

---

## ğŸ’¡ å­¦ã‚“ã ã“ã¨ï¼ˆHashMapï¼‰

- `HashMap::new()` ã§ä½œæˆã€`use` ãŒå¿…è¦
- `insert()` ã§è¿½åŠ ã€`get()` ã§å–å¾—ï¼ˆOptionï¼‰
- insert ã™ã‚‹ã¨ã‚­ãƒ¼ãƒ»å€¤ã®æ‰€æœ‰æ¨©ãŒ move
- `or_insert()` = ã€Œãªã‹ã£ãŸã‚‰æŒ¿å…¥ã€ã‚ã£ãŸã‚‰ãã®ã¾ã¾ã€

---

## ç¬¬8ç« ã¾ã¨ã‚

| ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ | C++ | ç”¨é€” |
|-------------|-----|------|
| `Vec<T>` | `vector<T>` | å¯å¤‰é•·é…åˆ— |
| `String` | `string` | æ–‡å­—åˆ—ï¼ˆUTF-8ï¼‰|
| `HashMap<K, V>` | `unordered_map` | ã‚­ãƒ¼ã¨å€¤ |

> **ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å®Œå…¨ã«ç†è§£ã—ãŸï¼** ğŸ¦€


